from typing import Dict, List, Callable
import abc
import queue

import numpy as np

from dream import model
from dream.experiment import model as experimentmodel


class ImageMetadataStore(abc.ABC):
    def atomically(self, cb: Callable[[any], None]) -> None:
        raise NotImplementedError("not yet implemented")

    def new_iter(self, tx: any) -> "ImageMetadataIterator":
        raise NotImplementedError("not yet implemented")


class ImageMetadataIterator(abc.ABC):
    def next(self) -> bool:
        raise NotImplementedError("not yet implemented")

    def curr(self) -> model.Image:
        raise NotImplementedError("not yet implemented")


def find_ideal_relevances(
    im_metadata_store: ImageMetadataStore,
    encode_caption_fn: experimentmodel.EncodeCaptionFn,
) -> Dict[str, List[float]]:
    test_caption_codes = {}

    # pylint: disable-next=consider-iterating-dictionary
    for test_caption in ideal_caption_relevances.keys():
        # there should always be exactly one code
        test_caption_codes[test_caption] = encode_caption_fn(test_caption)[0]

    return _find_ideal_relevances_for_caption(im_metadata_store, encode_caption_fn, test_caption_codes)


def _find_ideal_relevances_for_caption(
    im_metadata_store: ImageMetadataStore,
    encode_caption_fn: experimentmodel.EncodeCaptionFn,
    test_caption_codes: Dict[str, np.ndarray],
) -> Dict[str, List[float]]:
    ideal_scores_per_caption = {}

    def _cb(tx: any) -> None:
        nonlocal test_caption_codes
        nonlocal ideal_scores_per_caption

        im_iter = im_metadata_store.new_iter(tx)

        pqs = {}

        for caption in test_caption_codes.keys():
            pqs[caption] = queue.PriorityQueue()

        i = 0

        while im_iter.next():
            im = im_iter.curr()

            im_caption_codes = experimentmodel.im_caption_codes(im, encode_caption_fn)

            for test_caption in test_caption_codes.keys():
                test_caption_code = test_caption_codes[test_caption]

                rel_score = experimentmodel.relevance_score_of_codes(im_caption_codes, test_caption_code)

                pqs[test_caption].put(rel_score)

                if pqs[test_caption].qsize() > experimentmodel.MAX_N:
                    # The priority queue gives priority to smaller numbers.
                    pqs[test_caption].get()

            if i % 100 == 0:
                print("iterated ", i, " images from the database")

                for caption, pq in pqs.items():
                    print(f'current best for caption "{caption}": {pq.queue}')

            i += 1

        for caption, pq in pqs.items():
            ideal_scores_per_caption[caption] = pq.queue

    im_metadata_store.atomically(_cb)
    return ideal_scores_per_caption


# fmt: off
# pylint: disable=line-too-long
ideal_caption_relevances = {
    "cows in a farm": [0.78535545, 0.7855098, 0.7933688, 0.7893668, 0.7879807, 0.82560503, 0.79520774, 0.8227697, 0.793815, 0.81794584, 0.8755542, 0.892498, 0.84908676, 0.81325287, 0.8397068, 0.83233666, 0.823675, 0.80950344, 0.832116, 0.84220445],
    "giraffe being hunted in the savannah": [0.72052944, 0.7206063, 0.7381979, 0.7216425, 0.72930586, 0.7410472, 0.7391273, 0.72299767, 0.7292626, 0.7402233, 0.7465526, 0.7455047, 0.76263964, 0.741799, 0.75610304, 0.74967337, 0.73137945, 0.7381656, 0.7566645, 0.7564044],
    "people on a rainy day in the park": [0.73576117, 0.7372899, 0.7391782, 0.7379228, 0.7379828, 0.7432629, 0.74073243, 0.74287987, 0.7472352, 0.76241267, 0.88042736, 0.81137455, 0.75718194, 0.76001155, 0.7687906, 0.75582194, 0.86759275, 0.8321688, 0.75203955, 0.8718059],
    "little child having a snack": [0.78159, 0.7822733, 0.79252696, 0.79394656, 0.7855768, 0.79305553, 0.8119659, 0.81363803, 0.806857, 0.7917801, 0.8305174, 0.806857, 0.8226768, 0.8119777, 0.83344483, 0.8343475, 0.8254379, 0.82546526, 0.8357157, 0.8343475],
    "snowboard accident in a tree": [0.67153716, 0.6722851, 0.67159253, 0.6733232, 0.68339145, 0.7239325, 0.68906045, 0.6951541, 0.6813902, 0.7244275, 0.74664676, 0.7329649, 0.78083897, 0.69202054, 0.69204247, 0.7288001, 0.70138067, 0.74560237, 0.71817875, 0.7652178],
    "a person on a wedding": [0.6388382, 0.6412617, 0.64767015, 0.6505877, 0.65279436, 0.6729275, 0.6482978, 0.65076953, 0.6593642, 0.6712439, 0.7916888, 0.6856109, 0.6828717, 0.67216897, 0.6530734, 0.6551906, 0.69326776, 0.6601285, 0.67538464, 0.67797375],
    "tourists on an airport": [0.7301023, 0.7325803, 0.7307681, 0.7383776, 0.7361541, 0.7321863, 0.7333708, 0.743906, 0.7448522, 0.7536772, 0.7776947, 0.73224986, 0.75182235, 0.7830288, 0.7829126, 0.81230843, 0.75326455, 0.7561446, 0.7460644, 0.75385],
    "a fat american eating a hot dog": [0.819924, 0.82162476, 0.8360593, 0.82665086, 0.8220546, 0.85230815, 0.8361685, 0.8372781, 0.82875013, 0.8231133, 0.8328154, 0.85613567, 0.8523803, 0.8504202, 0.8523803, 0.85613567, 0.83941114, 0.85613567, 0.85613567, 0.85613567],
    "carrot dish": [0.763614, 0.7645305, 0.7641291, 0.77697355, 0.7681661, 0.7680245, 0.7655672, 0.79077727, 0.7856139, 0.76989067, 0.7898401, 0.7798347, 0.7955905, 0.77224267, 0.7713895, 0.8090453, 0.82346076, 0.78907955, 0.8012246, 0.81650287],
    "birds out for a fish": [0.68939626, 0.69143105, 0.6901839, 0.6958456, 0.70395815, 0.69790363, 0.69302785, 0.7105396, 0.69892454, 0.7246702, 0.71569896, 0.7202811, 0.76475275, 0.7295635, 0.7479952, 0.7157568, 0.7119988, 0.7399467, 0.7153131, 0.7403337],
    "a cup of coffee": [0.82436556, 0.8243772, 0.846856, 0.82623965, 0.8499022, 0.8763758, 0.84896487, 0.859296, 0.8285165, 0.87149906, 0.9121259, 0.8841715, 0.88171494, 0.8673066, 0.850289, 0.87149906, 0.8777822, 0.8657273, 0.8331451, 0.8953414],
    "a bully with a bat": [0.7012675, 0.7015772, 0.70306635, 0.7048196, 0.7027364, 0.70944625, 0.7055595, 0.7049111, 0.70885944, 0.71340704, 0.7962777, 0.7458052, 0.7095496, 0.7113403, 0.7175113, 0.70775974, 0.71157193, 0.7239001, 0.74803716, 0.71556973],
    "rainy traffic lights": [0.77520204, 0.77570033, 0.78385043, 0.79292566, 0.7868148, 0.8114892, 0.80784667, 0.79462886, 0.8114892, 0.8442791, 0.83651495, 0.8230674, 0.86452115, 0.82125175, 0.8149022, 0.82070535, 0.8371371, 0.81739354, 0.8193656, 0.84464616],
    "a duck in a fridge": [0.6611295, 0.6613492, 0.6619487, 0.6626824, 0.67283016, 0.6721902, 0.6627884, 0.6628902, 0.66757023, 0.6779665, 0.69036955, 0.6959157, 0.6802871, 0.6776594, 0.6828423, 0.6682613, 0.6640627, 0.6785648, 0.6865566, 0.68515],
    "baseball home run": [0.7506372, 0.7526307, 0.752439, 0.7547083, 0.7539581, 0.75944376, 0.754879, 0.7547083, 0.75782406, 0.7539896, 0.75565445, 0.8082042, 0.7890517, 0.7578914, 0.7587367, 0.76246727, 0.8229258, 0.80357313, 0.76999617, 0.7741338],
    "a cute girl with a teddy bear": [0.827199, 0.830238, 0.8358134, 0.8398939, 0.8338057, 0.8481952, 0.8728033, 0.85185194, 0.8421983, 0.84235036, 0.8428251, 0.84957194, 0.8681207, 0.8769425, 0.87795377, 0.8655565, 0.8665991, 0.8531169, 0.8712687, 0.8654012],
    "a person with skis in the Alps": [0.8109977, 0.81120825, 0.81810665, 0.8117613, 0.81132245, 0.81810665, 0.8298322, 0.82710487, 0.8137337, 0.82056844, 0.846432, 0.8319398, 0.832042, 0.84140235, 0.83505785, 0.8286103, 0.8481033, 0.84140235, 0.83240235, 0.84140235],
    "old photo": [0.67127633, 0.67150164, 0.683386, 0.6736647, 0.68605435, 0.6921236, 0.69735205, 0.6775831, 0.69149834, 0.6905173, 0.7186996, 0.69532263, 0.69249016, 0.74849653, 0.7800559, 0.7687286, 0.74862677, 0.7064949, 0.7115923, 0.8031317],
    "bike riders racing": [0.72864354, 0.72912073, 0.73579794, 0.7343646, 0.7308961, 0.7790326, 0.76367044, 0.7506569, 0.74594736, 0.7536136, 0.81047475, 0.78926873, 0.78378415, 0.8042401, 0.7656368, 0.7663213, 0.7721708, 0.81491935, 0.8023437, 0.84347165],
    "zebras on the run": [0.7869118, 0.79035026, 0.79386294, 0.7964264, 0.7938099, 0.7980951, 0.79718536, 0.807992, 0.81667614, 0.80962574, 0.83763456, 0.80521166, 0.8013922, 0.82060874, 0.81939614, 0.8112017, 0.8281607, 0.82240796, 0.816939, 0.8480316],
    "truck driver": [0.6755817, 0.67592984, 0.67836773, 0.6783812, 0.6776794, 0.6933676, 0.6891149, 0.6876566, 0.69749606, 0.6781734, 0.7165221, 0.7279733, 0.7162517, 0.70540524, 0.7305255, 0.6891724, 0.81225055, 0.7279793, 0.7175151, 0.75419027],
    "brushing teeth": [0.7461218, 0.7461218, 0.75742686, 0.7461218, 0.75766814, 0.7766327, 0.76800215, 0.7500236, 0.77202624, 0.7686974, 0.7906238, 0.7766327, 0.7766327, 0.77663267, 0.7906238, 0.8049391, 0.7598313, 0.77427006, 0.8399254, 0.8030822],
    "a dirty toilet" : [0.8923364, 0.8941493, 0.90461636, 0.8944212, 0.89497167, 0.91803855, 0.91497993, 0.9168767, 0.8986212, 0.9002688, 0.9115561, 0.93153375, 0.93331116, 0.9182129, 0.91787434, 0.9236795, 0.9319515, 0.8988607, 0.9395006, 0.9424473],
    "a clean toilet" : [0.8184214, 0.8192435, 0.8271698, 0.83526343, 0.82404065, 0.82760346, 0.8491496, 0.87873757, 0.8465039, 0.82760346, 0.87873745, 0.8375926, 0.8597988, 0.8585611, 0.9084706, 0.8845832, 0.8860365, 0.85717374, 0.8652116, 0.8611176],
    "sheep and shepherd dog" : [0.80263245, 0.8040767, 0.8072735, 0.8182136, 0.8080194, 0.8225485, 0.8204063, 0.82604975, 0.82148874, 0.8273168, 0.8083274, 0.8276216, 0.82696074, 0.82742655, 0.83186674, 0.83641475, 0.83151674, 0.8338182, 0.8283108, 0.8393979],
    "milk for santa" : [0.50232863, 0.5056652, 0.5145898, 0.50664335, 0.5065124, 0.52701426, 0.5299592, 0.51675856, 0.51024693, 0.5147391, 0.5134246, 0.5970688, 0.5612256, 0.5360007, 0.54076815, 0.5483532, 0.53006953, 0.5240065, 0.6000484, 0.60782003],
    "train toy" : [0.7991214, 0.8041958, 0.79953843, 0.8181393, 0.80631346, 0.8102937, 0.8180232, 0.83785427, 0.8382404, 0.8117348, 0.8434466, 0.87671983, 0.8365, 0.8293276, 0.8288367, 0.84011006, 0.85563457, 0.84275866, 0.8434466, 0.86000824],
    "surfer and shark" : [0.63866454, 0.63951707, 0.640414, 0.6413282, 0.63953704, 0.64042383, 0.64430475, 0.6471641, 0.64182127, 0.64011896, 0.6825745, 0.6463094, 0.6460079, 0.6766834, 0.65853846, 0.673409, 0.6604503, 0.66087353, 0.648402, 0.64701056],
    "banana desert" : [0.7254288, 0.7265782, 0.72593844, 0.7335076, 0.7282046, 0.732285, 0.72979015, 0.74346745, 0.7521229, 0.7366157, 0.7300876, 0.8816397, 0.74518275, 0.77578115, 0.75109863, 0.82335496, 0.7443127, 0.8075654, 0.81579, 0.74769765],
    "fishing on a boat in the ocean" : [0.7010894, 0.70126224, 0.7017951, 0.70197535, 0.7100235, 0.70731103, 0.72550845, 0.7041455, 0.71361554, 0.725361, 0.7503296, 0.715961, 0.78441054, 0.75775415, 0.7436948, 0.7592752, 0.7878375, 0.7404189, 0.7252204, 0.7524833],
    "kite with a child" : [0.8038882, 0.80419517, 0.8067968, 0.80502003, 0.806852, 0.8072315, 0.8119895, 0.806852, 0.8191127, 0.8100792, 0.8116127, 0.82615113, 0.82010174, 0.85937303, 0.84099215, 0.8560744, 0.82013917, 0.82003284, 0.8218714, 0.8461998],
    "kite on the beach" : [0.85224676, 0.8528595, 0.8534124, 0.8574505, 0.8564714, 0.85775614, 0.85753405, 0.86150646, 0.8588319, 0.8571416, 0.87757003, 0.9047928, 0.87825197, 0.8640971, 0.8648704, 0.8730626, 0.90072155, 0.886275, 0.89211476, 0.9190844],
    "elephant in its habitat" : [0.8154951, 0.8183111, 0.8173542, 0.8190571, 0.8261434, 0.8198702, 0.82785344, 0.8339355, 0.82174206, 0.8366194, 0.8631191, 0.9169154, 0.85871476, 0.8453409, 0.8315791, 0.9074738, 0.8343322, 0.83705294, 0.8350106, 0.88125837],
    "old people playing chess" : [0.4931455, 0.50026894, 0.49376756, 0.50247264, 0.5252029, 0.4950326, 0.5003143, 0.534743, 0.50280464, 0.53185266, 0.5505645, 0.51212585, 0.5466861, 0.53742015, 0.5076877, 0.5413605, 0.5508883, 0.50688165, 0.50564826, 0.61157453],
    "police car" : [0.7785258, 0.7824253, 0.7844273, 0.79129016, 0.8002306, 0.8210439, 0.78474426, 0.7921494, 0.8048494, 0.80076504, 0.83983004, 0.8252973, 0.8299334, 0.85859025, 0.80204797, 0.80209994, 0.8298179, 0.8426155, 0.8270615, 0.8634276],
    "meter on a parking" : [0.83365536, 0.83367336, 0.8504849, 0.83971447, 0.8350837, 0.8581283, 0.85313237, 0.8411517, 0.85497725, 0.84993273, 0.8600186, 0.8704907, 0.88427126, 0.85517406, 0.8601473, 0.87636435, 0.85116684, 0.8618015, 0.882127, 0.88027704],
    "business cat" : [0.61789787, 0.622307, 0.621426, 0.62762916, 0.62530804, 0.6421529, 0.6224211, 0.6405643, 0.63477784, 0.6277734, 0.63161564, 0.6536296, 0.64626, 0.64825165, 0.6884767, 0.65003943, 0.64967364, 0.67486763, 0.6372464, 0.65645325],
    "cat eating" : [0.72883046, 0.7300546, 0.74774826, 0.7502334, 0.75933194, 0.753824, 0.74781394, 0.75455177, 0.81844294, 0.7773975, 0.7771648, 0.8159691, 0.8006678, 0.757254, 0.8162112, 0.79188305, 0.7914796, 0.85154307, 0.82567376, 0.8636383],
    "salad with anchovies" : [0.7687587, 0.771001, 0.7714683, 0.77252305, 0.77861047, 0.7746579, 0.77830833, 0.7796583, 0.7784546, 0.77954876, 0.81916994, 0.7829883, 0.78387916, 0.7938887, 0.77845454, 0.7933583, 0.79191756, 0.7952067, 0.8052541, 0.83359766],
    "old people" : [0.59722126, 0.5977762, 0.61260116, 0.60973203, 0.60380274, 0.6294689, 0.6322685, 0.622983, 0.6121567, 0.6058005, 0.631111, 0.6522622, 0.6651264, 0.7090356, 0.6376973, 0.6767213, 0.64762115, 0.6156993, 0.6201249, 0.6385809],
    "fire fighters watering down a house" : [0.5897975, 0.59078866, 0.591294, 0.5940622, 0.5992147, 0.59813046, 0.6113133, 0.5998179, 0.59633505, 0.6084664, 0.6847628, 0.60870564, 0.6358569, 0.62908995, 0.71178293, 0.62190557, 0.61400056, 0.692744, 0.64462745, 0.6303785],
    "wooden table" : [0.73073447, 0.73091954, 0.7309773, 0.73511505, 0.73535466, 0.73382473, 0.74457884, 0.73934585, 0.756225, 0.74033916, 0.76546717, 0.8046249, 0.7366752, 0.8046249, 0.7450237, 0.7436676, 0.75146353, 0.79133743, 0.7681404, 0.75701964],
    "a lazy person watching tv" : [0.73623204, 0.7391744, 0.7398977, 0.7508812, 0.74214524, 0.746488, 0.74154603, 0.7567853, 0.7697101, 0.7448777, 0.7865124, 0.7628797, 0.75657094, 0.7493882, 0.7682462, 0.7628797, 0.76837915, 0.78842616, 0.78574836, 0.7970484],
    "a glass of white wine" : [0.8109199, 0.8126292, 0.81444335, 0.8199972, 0.813151, 0.8290538, 0.8152741, 0.841172, 0.82546145, 0.83059084, 0.84801733, 0.8946774, 0.8337884, 0.828564, 0.8217114, 0.8709234, 0.84174913, 0.94639385, 0.8448868, 0.8718295],
    "stop by the road" : [0.70580363, 0.7079915, 0.71071327, 0.7093486, 0.7093486, 0.71525455, 0.7174876, 0.71025014, 0.71071327, 0.7093486, 0.71906716, 0.72405887, 0.73117685, 0.7326993, 0.72684973, 0.7223919, 0.7108463, 0.7169993, 0.78278625, 0.74297523],
    "woman drying her hair" : [0.76672435, 0.77255917, 0.7818747, 0.7831105, 0.8051629, 0.8612114, 0.7856156, 0.7844968, 0.79754984, 0.88172317, 0.91711867, 0.9038229, 0.89204586, 0.79765654, 0.85123897, 0.94029737, 0.90409815, 0.9400875, 0.82680786, 0.9400875],
    "mountains" : [0.7346529, 0.7368349, 0.7399834, 0.74771726, 0.73714554, 0.74815077, 0.7418504, 0.75199443, 0.754531, 0.749634, 0.79494554, 0.7721916, 0.7710819, 0.80464184, 0.7745706, 0.75898826, 0.7640276, 0.77526784, 0.7705101, 0.7804079],
    "juicy fruit" : [0.7221454, 0.725866, 0.73282945, 0.72627366, 0.7582804, 0.73770726, 0.74087846, 0.7320073, 0.7315546, 0.7593254, 0.7966784, 0.7644702, 0.80443645, 0.7471814, 0.74957687, 0.7388691, 0.7826296, 0.7693641, 0.73931754, 0.8093983],
    "mom's good old sandwich" : [0.6840944, 0.68463624, 0.68463624, 0.6867454, 0.6874759, 0.68463624, 0.6902006, 0.6871272, 0.69682616, 0.68757737, 0.6973188, 0.6901976, 0.71070933, 0.70950484, 0.7150272, 0.69515634, 0.7040239, 0.70056206, 0.7040755, 0.72420037],
    "a broken clock on the wall" : [0.7358481, 0.7382835, 0.7452463, 0.7399058, 0.7451599, 0.748985, 0.7476692, 0.7437051, 0.7594724, 0.79197717, 0.9515752, 0.7500554, 0.7500782, 0.77483636, 0.7633901, 0.8263228, 0.76075864, 0.7984704, 0.7871752, 0.91911805],
    "tennis on clay" : [0.7788812, 0.77996075, 0.7837398, 0.78095424, 0.782419, 0.7944595, 0.7909906, 0.78528357, 0.782045, 0.80977255, 0.8314011, 0.7987425, 0.8386337, 0.7923149, 0.7916383, 0.79711914, 0.81767434, 0.7977817, 0.78642887, 0.81758285],
    "traffic lights on a sunny day" : [0.768245, 0.768843, 0.7710131, 0.77533996, 0.76962805, 0.7731104, 0.77244806, 0.7776147, 0.775839, 0.7764045, 0.77700454, 0.77720916, 0.7769541, 0.81591445, 0.78451836, 0.80252635, 0.7790773, 0.79860866, 0.7917066, 0.7937664],
    "big books" : [0.6085155, 0.60883087, 0.6179061, 0.6207824, 0.61301214, 0.6339247, 0.6252731, 0.62260514, 0.6291183, 0.6176825, 0.62569666, 0.64898354, 0.65804064, 0.6299509, 0.6324882, 0.6702888, 0.64825225, 0.63490963, 0.65650713, 0.6439533],
    "swimming in a boat" : [0.6701724, 0.67082655, 0.67082655, 0.676913, 0.67316043, 0.6782087, 0.6765852, 0.6776351, 0.6773733, 0.6760024, 0.6902249, 0.68472713, 0.6803554, 0.6892278, 0.6776351, 0.7091789, 0.70454836, 0.71887195, 0.7157425, 0.710835],
    "canoe" : [0.67383707, 0.6740868, 0.679939, 0.6839075, 0.6752265, 0.6806374, 0.69697315, 0.6871171, 0.686676, 0.70554745, 0.71523553, 0.6898297, 0.7493055, 0.6989622, 0.7001217, 0.72992194, 0.7331021, 0.7100956, 0.7077653, 0.7105441],
    "bear with fish in the river" : [0.781947, 0.78521246, 0.80901873, 0.8180795, 0.7892635, 0.82714486, 0.8339925, 0.8415005, 0.88955355, 0.8137957, 0.8549264, 0.836485, 0.87399924, 0.90643716, 0.8348834, 0.87945604, 0.87133414, 0.90393317, 0.91407615, 0.89101064],
    "polar bear" : [0.77748466, 0.7780445, 0.7834414, 0.7855028, 0.7835685, 0.784325, 0.7906743, 0.79231846, 0.78987694, 0.7924758, 0.8047725, 0.792716, 0.7912278, 0.8069447, 0.7936944, 0.81326383, 0.7934148, 0.7946367, 0.8274571, 0.8379516],
    "black bear" : [0.75356436, 0.75358206, 0.7725192, 0.7612541, 0.7538905, 0.79112494, 0.7737688, 0.7760895, 0.7712459, 0.75958973, 0.7564623, 0.8030504, 0.8328266, 0.8135873, 0.78595954, 0.7892865, 0.78832865, 0.80567116, 0.8081393, 0.7743499],
    "broccoli" : [0.8259526, 0.826042, 0.833982, 0.8290096, 0.83321065, 0.84115803, 0.8366121, 0.85528183, 0.8353462, 0.8413956, 0.86099154, 0.8422604, 0.84403753, 0.88234127, 0.85221183, 0.86122274, 0.8809076, 0.84370494, 0.84180033, 0.8721459],
    "a green edible plant" : [0.7400379, 0.7475606, 0.7523389, 0.7479062, 0.75434244, 0.76417816, 0.7662139, 0.7542645, 0.7488928, 0.78464895, 0.7620032, 0.7891553, 0.76496565, 0.8064022, 0.7884461, 0.77140146, 0.8326453, 0.7647522, 0.7606585, 0.7858401],
    "old keyboard" : [0.710814, 0.7108936, 0.71155727, 0.71202016, 0.7115316, 0.71379733, 0.73685074, 0.7186382, 0.7360078, 0.72339994, 0.7984692, 0.7356497, 0.7332667, 0.75486875, 0.77418363, 0.7294479, 0.76971245, 0.74042857, 0.75222206, 0.76004237],
    "computer mouse" : [0.81594026, 0.82060623, 0.8188461, 0.820964, 0.8208278, 0.82060623, 0.83218646, 0.82561976, 0.83160055, 0.8367156, 0.830891, 0.82577586, 0.82497096, 0.8611864, 0.8376191, 0.85784686, 0.83905166, 0.84570605, 0.84758717, 0.87594616],
    "kitchen sink with dirty dishes" : [0.77495885, 0.77513576, 0.78580624, 0.77772415, 0.7800644, 0.8070232, 0.8294039, 0.78353906, 0.79122543, 0.78550303, 0.9249996, 0.92554927, 0.8472111, 0.8306318, 0.88427377, 0.94711447, 0.8718829, 0.80605805, 0.8081809, 0.9780773],
    "clean kitchen sink" : [0.80700874, 0.8084121, 0.8090091, 0.8093028, 0.8091869, 0.8141956, 0.813455, 0.81939423, 0.8140949, 0.84997463, 0.8766913, 0.8433223, 0.82298166, 0.8155299, 0.8326179, 0.8412669, 0.8284563, 0.8755162, 0.8176131, 0.86854184],
    "old horse racer" : [0.6905503, 0.69141793, 0.69142616, 0.69465584, 0.70273036, 0.6946708, 0.6948456, 0.7087337, 0.7101301, 0.717553, 0.71987337, 0.7183298, 0.699302, 0.77939856, 0.74722487, 0.7115172, 0.71411586, 0.7167397, 0.73192096, 0.72787106],
    "vase with roses" : [0.8366147, 0.83815694, 0.8412301, 0.8419955, 0.84178126, 0.8466467, 0.8457827, 0.8580985, 0.84481144, 0.84252226, 0.8479427, 0.8697186, 0.8527411, 0.84690994, 0.8497999, 0.86928225, 0.86495656, 0.8551407, 0.86713564, 0.8903645],
    "reader on a bench" : [0.7045227, 0.7116106, 0.71295255, 0.71349156, 0.7168298, 0.7233877, 0.7206291, 0.73279774, 0.7153082, 0.7300979, 0.75857997, 0.7474097, 0.7555635, 0.7387029, 0.7411495, 0.7620646, 0.73598135, 0.7241826, 0.75873125, 0.7646531],
    "laptop and tv" : [0.75630283, 0.75746155, 0.7633848, 0.76970434, 0.7594054, 0.7771489, 0.80360824, 0.77945524, 0.7713089, 0.79206073, 0.8073039, 0.78978574, 0.7810252, 0.8037754, 0.81587386, 0.81734467, 0.81510264, 0.78064555, 0.805912, 0.8376837],
    "a cooking device" : [0.6980267, 0.69882035, 0.69909555, 0.699473, 0.69966567, 0.69967306, 0.7046037, 0.7000828, 0.7316239, 0.7028458, 0.72967654, 0.7202471, 0.7181755, 0.72302735, 0.7048797, 0.7392517, 0.72627, 0.7505576, 0.7803141, 0.8548174],
    "a cold place" : [0.6679393, 0.6709753, 0.68428886, 0.6740726, 0.67213035, 0.6890141, 0.6981591, 0.6852244, 0.68243515, 0.6759903, 0.71651816, 0.761743, 0.7365406, 0.7097312, 0.71400714, 0.69506043, 0.72293866, 0.70956135, 0.72248566, 0.71274316],
    "starting the tv" : [0.6207551, 0.6241372, 0.626387, 0.6259419, 0.6254518, 0.62701154, 0.6415297, 0.6315809, 0.63089097, 0.6342324, 0.63423246, 0.6432145, 0.6342324, 0.6544929, 0.6458826, 0.64047, 0.6544929, 0.63093746, 0.65050876, 0.65911996],
    "a banana  tree" : [0.85729325, 0.857849, 0.86450344, 0.85938025, 0.86742544, 0.8799294, 0.8720694, 0.902321, 0.88826346, 0.8712995, 0.86902654, 0.88912904, 0.8884338, 0.88786095, 0.88279605, 0.9144329, 0.9140923, 0.8948329, 0.89535606, 0.92416376],
    "a yellow fruit" : [0.69554985, 0.7007063, 0.70359653, 0.70149803, 0.70351636, 0.70781386, 0.71307117, 0.70810115, 0.7054597, 0.7067485, 0.73432493, 0.72631097, 0.7137952, 0.7323257, 0.73255014, 0.7403562, 0.7612493, 0.70791984, 0.71055126, 0.7245853],
    "baking bread" : [0.712971, 0.7203103, 0.7130556, 0.7370396, 0.7243125, 0.73013365, 0.7367752, 0.7453809, 0.74367905, 0.7267931, 0.76637363, 0.7935289, 0.8502507, 0.75757694, 0.7552155, 0.7763828, 0.7715794, 0.81575567, 0.7690408, 0.86091566],
    "falling asleep" : [0.57967436, 0.579988, 0.58322495, 0.59081674, 0.58775985, 0.59274596, 0.595166, 0.5949831, 0.5965246, 0.6046436, 0.6234174, 0.61575866, 0.59693456, 0.6005715, 0.63408744, 0.597456, 0.619437, 0.6049576, 0.5971323, 0.6355204],
    "air battle" : [0.5656196, 0.56616116, 0.566197, 0.57312775, 0.5848844, 0.57857245, 0.5805112, 0.57717013, 0.576946, 0.5931957, 0.6496301, 0.6037818, 0.578767, 0.6099712, 0.5865177, 0.655134, 0.5971474, 0.5835163, 0.586897, 0.63022745],
    "broken phone" : [0.56696874, 0.56980115, 0.5703153, 0.5709986, 0.5768811, 0.60153806, 0.6105015, 0.57530594, 0.60070014, 0.7247853, 0.6970407, 0.6130843, 0.720006, 0.6108066, 0.7117845, 0.578586, 0.6172161, 0.8227172, 0.6246783, 0.80596757],
    "dog catch a frisbee" : [0.89359546, 0.8958318, 0.89601207, 0.8999152, 0.8964833, 0.8992388, 0.91031724, 0.9011791, 0.90632355, 0.89951646, 0.91360575, 0.9012708, 0.8992859, 0.91454124, 0.91031724, 0.91849554, 0.9069232, 0.9066801, 0.91351426, 0.90826666],
    "italian pizza" : [0.7562951, 0.75685585, 0.75816584, 0.7584309, 0.7570008, 0.76015395, 0.76323915, 0.7613226, 0.77367646, 0.7639816, 0.76272196, 0.76426643, 0.8206399, 0.7693932, 0.7831999, 0.76348364, 0.78287596, 0.78751045, 0.8096484, 0.82786536],
    "child with a fork" : [0.721461, 0.72166383, 0.7543389, 0.72942483, 0.7560558, 0.79358566, 0.7754792, 0.7368106, 0.74822986, 0.7586544, 0.7604296, 0.7957318, 0.85836875, 0.8524853, 0.81074095, 0.7442391, 0.7957216, 0.81151396, 0.7818526, 0.79156566],
    "french fries" : [0.7817495, 0.78462064, 0.7833049, 0.7933793, 0.79602873, 0.78485274, 0.7934259, 0.7994488, 0.82367563, 0.8421801, 0.8390136, 0.7860111, 0.78769505, 0.82553667, 0.8390136, 0.8390136, 0.8062428, 0.8390136, 0.8390136, 0.8469506],
    "a professor" : [0.49839368, 0.49851173, 0.5022855, 0.5029383, 0.49896163, 0.5143756, 0.5037534, 0.50339836, 0.5126502, 0.50059783, 0.5302942, 0.5654553, 0.5843649, 0.5491555, 0.521909, 0.5078217, 0.53689003, 0.61801136, 0.5427917, 0.577075],
    "green sofa" : [0.7475092, 0.7497605, 0.7520026, 0.7606194, 0.7718739, 0.81243455, 0.7667444, 0.8282434, 0.8176379, 0.8169278, 0.8171422, 0.8187941, 0.86618984, 0.8323996, 0.8156697, 0.8549936, 0.8371013, 0.8250686, 0.8398361, 0.8268515],
    "tennis ball" : [0.7665576, 0.7665576, 0.7704291, 0.7665576, 0.7665576, 0.77567846, 0.787433, 0.8040241, 0.7705231, 0.7848406, 0.83185, 0.8480778, 0.8051665, 0.8230384, 0.81454504, 0.83398604, 0.82452273, 0.8041288, 0.7802588, 0.8373333],
    "hide from rain" : [0.5347644, 0.53598493, 0.54200417, 0.5366512, 0.54754937, 0.56117165, 0.5493727, 0.562448, 0.5471563, 0.559221, 0.57150364, 0.5787657, 0.60064334, 0.56218207, 0.5931009, 0.56535584, 0.60712266, 0.558048, 0.55680394, 0.72219205],
    "pasta" : [0.8005855, 0.80096513, 0.80402446, 0.8032001, 0.80338913, 0.8071048, 0.81282616, 0.80755246, 0.818877, 0.8039625, 0.81848013, 0.84300673, 0.8105465, 0.8164606, 0.81432045, 0.81333494, 0.80906093, 0.8739089, 0.82807916, 0.82333934],
    "rider on horse" : [0.81578964, 0.8179472, 0.81760955, 0.8182098, 0.82075834, 0.8182776, 0.8316791, 0.8199864, 0.8263022, 0.8235717, 0.832403, 0.8190661, 0.84962106, 0.8475201, 0.8396379, 0.8364731, 0.82681787, 0.8263022, 0.8430077, 0.8430077],
    "a pond" : [0.7124057, 0.7184283, 0.71349895, 0.72269404, 0.72384614, 0.73664165, 0.7191952, 0.72471076, 0.73367107, 0.72734696, 0.76160747, 0.7696375, 0.75187504, 0.80186546, 0.7314161, 0.77048403, 0.7889888, 0.7573118, 0.7356355, 0.7919692],
    "luxurious house" : [0.6261779, 0.6287309, 0.6375003, 0.6302516, 0.63179934, 0.6382167, 0.64500535, 0.69035065, 0.6345375, 0.63391626, 0.6379346, 0.6454382, 0.6492629, 0.6619077, 0.6919257, 0.7093668, 0.7139907, 0.63998866, 0.6508868, 0.6797693],
    "elephant drinking water" : [0.81884885, 0.81955326, 0.83129925, 0.83170676, 0.8302648, 0.8420841, 0.84414256, 0.83202296, 0.87219095, 0.83152217, 0.92231846, 0.8926359, 0.8488095, 0.88213634, 0.856875, 0.8770006, 0.8407883, 0.9283478, 0.8995601, 0.8887824],
    "grapes" : [0.69480145, 0.7035458, 0.70320743, 0.7215085, 0.70388114, 0.7229556, 0.75047946, 0.7248006, 0.730773, 0.7110491, 0.7334974, 0.7319853, 0.72351146, 0.78825593, 0.8053849, 0.76307833, 0.7506531, 0.77681553, 0.77714133, 0.7864863],
    "hunting dog" : [0.5610658, 0.5614939, 0.56562537, 0.56242436, 0.56192327, 0.5707953, 0.5671504, 0.56804824, 0.5647252, 0.5629363, 0.565845, 0.5741848, 0.6198311, 0.5766592, 0.5869789, 0.5751617, 0.57004476, 0.63365567, 0.59961015, 0.6046793],
    "cup of rice" : [0.6885228, 0.6887034, 0.6933447, 0.6894573, 0.6925628, 0.69542587, 0.708164, 0.71054274, 0.69414294, 0.6934699, 0.77208114, 0.7099823, 0.7012073, 0.751813, 0.71921897, 0.71872175, 0.79535055, 0.7108985, 0.74273735, 0.7691152],
    "chicken wings" : [0.5681218, 0.5776414, 0.56932956, 0.5794797, 0.57836616, 0.57106566, 0.5763342, 0.5814979, 0.58397657, 0.59463423, 0.58499116, 0.58157235, 0.596946, 0.58661455, 0.64855874, 0.72465235, 0.6058241, 0.6128346, 0.6065842, 0.6054978],
    "sandwich cuts" : [0.7810407, 0.7811095, 0.78339195, 0.7864087, 0.7829139, 0.8024894, 0.794644, 0.78781915, 0.80232954, 0.81609356, 0.80203795, 0.8140863, 0.83806115, 0.8465712, 0.8358948, 0.82091194, 0.7970273, 0.83629155, 0.8240768, 0.84015775],
    "people with a suitcase" : [0.7755361, 0.7756096, 0.7938088, 0.7793813, 0.77561605, 0.79563427, 0.7968908, 0.7834471, 0.78242546, 0.7830941, 0.8033004, 0.80862904, 0.797521, 0.83856404, 0.8320098, 0.78695035, 0.7874801, 0.7891852, 0.78743154, 0.83287424],
    "road sign" : [0.7537539, 0.7569943, 0.7642075, 0.7596306, 0.7652743, 0.7654805, 0.76636475, 0.7630638, 0.7651187, 0.7849289, 0.79766923, 0.7814703, 0.78996134, 0.7888179, 0.80029684, 0.7804605, 0.78359294, 0.76636475, 0.76918083, 0.7956259],
    "electronic device" : [0.72314215, 0.72465, 0.72829986, 0.7286386, 0.7255888, 0.73439324, 0.742484, 0.76731795, 0.7373347, 0.75226754, 0.7617295, 0.7748654, 0.73800063, 0.79936695, 0.76482224, 0.80239594, 0.7765349, 0.75465065, 0.7525978, 0.80208355],
    "green" : [0.6008344, 0.60140777, 0.604649, 0.60563207, 0.60196114, 0.62795985, 0.610109, 0.61588675, 0.61598665, 0.62254155, 0.63093257, 0.66989, 0.63117695, 0.63203216, 0.6139201, 0.6632716, 0.62463844, 0.6257389, 0.6216785, 0.6319258],
    "halloween costume" : [0.63755846, 0.6407062, 0.6429768, 0.6534718, 0.6675823, 0.6442356, 0.65956557, 0.6867472, 0.6540828, 0.6791049, 0.79143775, 0.67984843, 0.6493825, 0.7187123, 0.69279754, 0.6880576, 0.73276645, 0.6868636, 0.662483, 0.7686632],
}
# pylint: enable=line-too-long
# fmt: on
